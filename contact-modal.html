<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Us</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: transparent; /* Important for modal overlay */
        color: #1a1a1a;
        margin: 0;
        padding: 1rem; /* Padding for small screens if not full modal */
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh; /* Ensure it takes full height when loaded in iframe */
      }
      .contact-card {
        background: linear-gradient(145deg, #f0f4f8 0%, #ffffff 100%); /* Subtle gradient background */
        border-radius: 0.75rem;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15); /* More prominent shadow */
        padding: 2.5rem; /* Increased padding */
        max-width: 600px;
        width: 100%;
        position: relative;
        border: 1px solid #e0e7ff; /* Light blue border */
        overflow-y: hidden; /* This is the key change */
      }
      .form-group {
        margin-bottom: 1.25rem;
      }
      .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #374151;
      }
      .form-group input,
      .form-group textarea,
      .form-group select {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        font-size: 1rem;
        color: #374151;
        background-color: #f9fafb;
        transition: border-color 0.3s, box-shadow 0.3s; /* Smoother transition */
      }
      .form-group input:focus,
      .form-group textarea:focus,
      .form-group select:focus {
        outline: none;
        border-color: #0052cc;
        box-shadow: 0 0 0 4px rgba(0, 82, 204, 0.3); /* More vibrant shadow on focus */
      }
      .submit-button {
        background: linear-gradient(90deg, #0052cc 0%, #003f99 100%); /* Gradient button */
        color: white;
        padding: 0.85rem 1.75rem; /* Slightly larger padding */
        border-radius: 0.5rem;
        font-weight: 700; /* Bolder text */
        font-size: 1.05rem; /* Slightly larger font */
        transition: all 0.3s ease; /* Smooth transition for all properties */
        box-shadow: 0 6px 12px rgba(0, 82, 204, 0.25); /* More prominent shadow */
        width: 100%;
        cursor: pointer;
        border: none; /* Remove default button border */
      }
      .submit-button:hover {
        background: linear-gradient(90deg, #003f99 0%, #002a66 100%); /* Darker gradient on hover */
        transform: translateY(-3px); /* More pronounced lift */
        box-shadow: 0 8px 16px rgba(0, 82, 204, 0.35); /* Stronger shadow on hover */
      }
      .error-message {
        color: #ef4444;
        font-size: 0.875rem;
        margin-top: 0.5rem;
      }
      .form-group.checkbox-group {
        display: flex;
        align-items: flex-start;
        margin-top: 1.5rem;
      }
      .form-group.checkbox-group input[type="checkbox"] {
        flex-shrink: 0;
        margin-top: 0.25rem;
        margin-right: 0.75rem;
        width: 1.25rem;
        height: 1.25rem;
      }
      .form-group.checkbox-group label {
        display: flex;
        align-items: flex-start;
        margin-bottom: 0;
        font-weight: 400;
      }
      .form-group.checkbox-group .text-sm {
        font-size: 0.875rem;
        line-height: 1.25rem;
        color: #4b5563;
      }
      .form-group.checkbox-group .text-xs {
        font-size: 0.75rem;
        line-height: 1rem;
        color: #6b7280;
      }
      .success-message {
        text-align: center;
        padding: 3rem 2rem; /* More padding */
        color: #16a34a; /* Darker green */
        font-size: 1.5rem; /* Larger font */
        font-weight: 700; /* Bolder */
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
      .success-message svg {
          width: 3.5rem; /* Larger icon */
          height: 3.5rem;
          color: #22c55e; /* Green checkmark */
      }
      .modal-header-logo {
          display: flex;
          justify-content: center;
          margin-bottom: 1.5rem; /* Space below logo */
      }
      .modal-header-logo img { /* Styling for the image logo */
          width: 4rem; /* Larger logo size */
          height: 4rem;
          object-fit: cover;
          border-radius: 50%; /* Make it circular if button.png is square */
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body>
    <div class="contact-card">
      <div class="modal-header-logo">
        <img src="assets/button.png" alt="Moontrace Logo" onerror="this.onerror=null;this.src='https://placehold.co/64x64/0052cc/ffffff?text=Logo';" />
      </div>
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Get in Touch</h2>
      <div id="form-container">
        <form id="contact-form" action="https://formspree.io/f/xpwlozaq" method="POST">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-group">
              <label for="first-name">First Name</label>
              <input type="text" id="first-name" name="firstName" required class="rounded-md" />
            </div>
            <div class="form-group">
              <label for="last-name">Last Name</label>
              <input type="text" id="last-name" name="lastName" required class="rounded-md" />
            </div>
          </div>
          <div class="form-group">
            <label for="company-name">Company Name</label>
            <input type="text" id="company-name" name="companyName" required class="rounded-md" />
          </div>
          <div class="form-group">
            <label for="business-email">Email</label>
            <input type="email" id="business-email" name="email" required class="rounded-md" />
          </div>
          <div class="form-group">
            <label for="message">Message</label>
            <textarea id="message" name="message" rows="4" required class="rounded-md"></textarea>
          </div>
          <div class="form-group checkbox-group">
            <input type="checkbox" id="consent" name="consent" class="form-checkbox h-5 w-5 text-blue-600 rounded" />
            <div>
              <label for="consent" class="text-sm">
                I agree to receive other communications from Moontrace.
              </label>
              <p class="text-xs mt-1">
                You may unsubscribe from these communications at any time. For more information, please review our Privacy Policy.
              </p>
            </div>
          </div>
          <button type="submit" class="submit-button mt-6">Send Message</button>
        </form>
      </div>
      <div id="success-message" class="success-message hidden">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <p>Thank you for your message! We'll get back to you soon.</p>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const contactForm = document.getElementById('contact-form');
        const formContainer = document.getElementById('form-container');
        const successMessageDiv = document.getElementById('success-message');

        contactForm.addEventListener('submit', async function(event) {
          event.preventDefault(); // Prevent default form submission

          if (!contactForm.checkValidity()) {
            contactForm.reportValidity(); // Trigger HTML5 validation messages
            return; // Stop submission
          }

          const form = event.target;
          const formData = new FormData(form);

          try {
            const response = await fetch(form.action, {
              method: 'POST',
              body: formData,
              headers: {
                'Accept': 'application/json'
              }
            });

            if (response.ok) {
              formContainer.classList.add('hidden');
              successMessageDiv.classList.remove('hidden');
              // Optionally, you can add a timer to close the modal after some seconds
              // if (window.parent && window.parent.hideContactModal) {
              //   setTimeout(() => {
              //     window.parent.hideContactModal();
              //   }, 3000);
              // }
            } else {
              const data = await response.json();
              if (data.errors) {
                const errorMessage = 'Form submission failed: ' + data.errors.map(e => e.message).join(', ');
                displayMessageBox(errorMessage);
              } else {
                displayMessageBox('Form submission failed. Please try again.');
              }
            }
          } catch (error) {
            console.error('Error submitting form:', error);
            displayMessageBox('An error occurred. Please try again later.');
          }
        });

        function displayMessageBox(message) {
            const messageBox = document.createElement('div');
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #fff;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
                z-index: 9999;
                text-align: center;
                font-family: 'Inter', sans-serif;
                color: #1a1a1a;
                max-width: 300px;
            `;
            messageBox.innerHTML = `
                <p>${message}</p>
                <button onclick="this.parentNode.remove()" style="
                    background-color: #0052cc;
                    color: white;
                    padding: 8px 15px;
                    border-radius: 5px;
                    margin-top: 15px;
                    cursor: pointer;
                    border: none;
                ">OK</button>
            `;
            document.body.appendChild(messageBox);
        }
      });
    </script>
  </body>
</html>